<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean AI</title>
    <meta name="description" content="Portfolio for world-renowned software engineer soyeon">
    <meta name="author" content="soyeon">

    <script src="https://kit.fontawesome.com/7ebfe642cb.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="studioStyle.css"/>
    <script src="home.js" defer></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.4.1/dist/email.min.js"> </script>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
</head>

<body>
     <nav id="navbar">
        <div class="navbar__logo"> 
            <a href="index.html">Ocean Ai</a>
        </div>
            <ul class="navbar__menu">
                  <a href="studio.html"><li class="navbar__menu__item" data-link="#about">디자인스튜디오</li></a>
                <a href="mart.html"><li class="navbar__menu__item" data-link="#skills">금융데이터마트</li></a>
                <a href="gallery.html"><li class="navbar__menu__item" data-link="#work">포트폴리오갤러리</li></a>
                <a href="admin.html"><li class="navbar__menu__item" data-link="#contact">작업관리자</li></a>
            </ul>
        </div>
        <!-- Toggle button -->
        <button class="navbar__toggle-btn">
            <i class="fas fa-bars"></i>
        </button>
    </nav>

    <section id="home">
<div class="wrap">

  <!-- 상단: 블록 게이지 -->
  <div class="card">
    <div class="block-gauge" id="gauge" aria-label="단계 게이지(클릭 가능)"></div>
  </div>

  <!-- 하단: 도넛 + 범례 -->
  <div class="card">
    <div class="main">
      <div class="box">
        <h2 id="stepTitle">1단계</h2>
        <svg id="donut" viewBox="0 0 240 240" aria-label="도넛차트">
          <circle cx="120" cy="120" r="84" fill="none" stroke="#eef1f5" stroke-width="24"/>
          <g id="segments" transform="rotate(-90 120 120)"></g>
          <g>
            <text x="120" y="110" class="centerText muted" font-size="12">완료</text>
            <text id="centerMain" x="120" y="130" class="centerText">0 / 5</text>
          </g>
        </svg>
        <div class="hint">• 블록을 누르면 해당 단계로 전환되며 도넛은 초기화됩니다. 일부 선택=회색, 전부 선택=파란색.</div>
      </div>
      <div class="box">
        <h2>범례 & 컨트롤</h2>
        <div id="legend" class="legend"></div>
        <div class="controls">
          <button id="selectAll">전체 선택</button>
          <button id="clearAll">전체 해제</button>
        </div>
      </div>
    </div>
  </div>

</div>
    </section> 

    <section id="about" class="section">
        <a href="studio.html" ><h3>1</h3></a>
        <a href="studio2.html" ><h3>2</h3></a>
        <a href="" ><h3>3</h3></a>
        <a href="" ><h3>4</h3></a>
        <a href="" ><h3>5</h3></a>
    </section>

    <section id="skills" class="section">

    </section>


</body>
</html>

<script>
/* ===== 단계/노드 ===== */
const steps = [
  { name:"데이터 선택",    nodes:["데이터","특성","타깃","기간","검증"] },
  { name:"전처리 설정",    nodes:["결측치","스케일","인코딩","파생","샘플링"] },
  { name:"모델 구성",      nodes:["n_estimators","max_depth","max_features","criterion","seed"] },
  { name:"학습/검증 분할", nodes:["train","valid","test","k-fold","shuffle"] },
  { name:"평가/리포트",    nodes:["정확도","AUC","F1","리포트","리프트"] },
];

let currentStep = 0;
let data = [];
const blockStates = Array(steps.length).fill("empty"); // "empty" | "partial" | "done"

/* ===== 엘리먼트 ===== */
const gaugeEl   = document.getElementById('gauge');
const stepTitle = document.getElementById('stepTitle');
const segGroup  = document.getElementById('segments');
const centerMain= document.getElementById('centerMain');
const legend    = document.getElementById('legend');

/* ===== 게이지 렌더 (이벤트 위임) ===== */
function renderGauge(){
  gaugeEl.innerHTML = '';
  steps.forEach((s,i)=>{
    const div = document.createElement('div');
    div.className = 'gblock'
      + (i===currentStep ? ' active' : '')
      + (blockStates[i]==='partial' ? ' partial' : '')
      + (blockStates[i]==='done' ? ' done' : '');
    div.dataset.index = i;

    // 화면 표시용 라벨
    div.setAttribute('data-label', `${i+1}단계 · ${s.name}`);

    // 툴팁도 유지
    div.title = `${i+1}단계 · ${s.name}`;

    gaugeEl.appendChild(div);
  });
}

/* 컨테이너 한 곳에만 클릭 바인딩(재렌더링에도 유지) */
gaugeEl.addEventListener('click', (e)=>{
  const blk = e.target.closest('.gblock');
  if(!blk) return;
  const i = +blk.dataset.index;
  selectBlock(i);
});

function selectBlock(i){
  currentStep = i;
  blockStates[i] = 'empty';        // 규칙: 블록 진입 = 항상 초기화 상태
  initDonutForStep(i, true);       // 도넛 완전 초기화
  renderGauge();                   // Active 테두리 반영
}

/* ===== 도넛 ===== */
const cfg = { cx:120, cy:120, r:84, width:24, gapDeg:4,
  colorOn:getComputedStyle(document.documentElement).getPropertyValue('--accent').trim(),
  colorOff:getComputedStyle(document.documentElement).getPropertyValue('--base').trim()
};
const toRad = d => (Math.PI/180)*d;
const polar = (cx,cy,r,a)=>({ x: cx + r*Math.cos(toRad(a)), y: cy + r*Math.sin(toRad(a)) });
function arcPath(cx,cy,r,start,end){
  const s=polar(cx,cy,r,start), e=polar(cx,cy,r,end);
  const large = ((end-start)%360) > 180 ? 1 : 0;
  return `M ${s.x} ${s.y} A ${r} ${r} 0 ${large} 1 ${e.x} ${e.y}`;
}

function initDonutForStep(stepIdx, forceReset=false){
  const nodes = steps[stepIdx].nodes;
  data = nodes.map(n => ({ label:n, value:1, selected:false })); // 항상 비워서 시작
  drawDonut();
}

function drawDonut(){
  segGroup.innerHTML = '';
  stepTitle.textContent = `${currentStep+1}단계 · ${steps[currentStep].name}`;

  const total = data.length;
  const gaps  = cfg.gapDeg * data.length;
  let cur = 0;

  data.forEach((d,i)=>{
    const sweep = (d.value/total) * (360 - gaps);
    const start = cur, end = cur + sweep; cur = end + cfg.gapDeg;

    const path = document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('d', arcPath(cfg.cx,cfg.cy,cfg.r,start,end));
    path.setAttribute('fill','none');
    path.setAttribute('stroke', d.selected ? cfg.colorOn : cfg.colorOff);
    path.setAttribute('stroke-width', cfg.width);
    path.setAttribute('stroke-linecap','round');
    path.classList.add('seg');
    path.addEventListener('click', ()=> toggleSeg(i));
    segGroup.appendChild(path);
  });

  applyStateToCurrentBlock();
  renderLegend();
}

function toggleSeg(i){
  data[i].selected = !data[i].selected;
  // 도넛 다시 그리면서 상태 재평가
  drawDonut();
}

function applyStateToCurrentBlock(){
  const done = data.filter(d=>d.selected).length;
  const total = data.length;
  centerMain.textContent = `${done} / ${total}`;

  const state = (done === 0) ? 'empty' : (done < total ? 'partial' : 'done');
  blockStates[currentStep] = state;
  renderGauge(); // 상태 클래스 반영(이벤트 위임이라 클릭 문제 없음)
}

/* ===== 범례/컨트롤 ===== */
function renderLegend(){
  legend.innerHTML = '';
  data.forEach((d,i)=>{
    const chip = document.createElement('div');
    chip.className = `chip ${d.selected ? 'active' : ''}`;
    chip.textContent = d.label;
    chip.addEventListener('click', ()=> toggleSeg(i));
    legend.appendChild(chip);
  });
}
document.getElementById('selectAll').addEventListener('click', ()=>{
  data.forEach(d=>d.selected=true); drawDonut();
});
document.getElementById('clearAll').addEventListener('click', ()=>{
  data.forEach(d=>d.selected=false); drawDonut();
});

/* ===== 초기 실행 ===== */
renderGauge();
initDonutForStep(currentStep, true);
</script>