<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean AI</title>
    <meta name="description" content="Portfolio for world-renowned software engineer soyeon">
    <meta name="author" content="soyeon">

    <script src="https://kit.fontawesome.com/7ebfe642cb.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="studioStyle2.css"/>
    <script src="studio2.js" defer></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.4.1/dist/email.min.js"> </script>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
</head>

<body>
    <section id="home">
      <div id="stage" class="shrink-wrap">

        
          <!-- 기존 콘텐츠 -->
        <div class="shrink-scale">
          <div class="your-panel">
            <div class="wrap">
                <!-- 하단: 도넛 + 범례 -->
                <div class="card"  data-step="0">
                  <div class="main">
                    <div class="box" id="donutBox">
                      <h2 id="stepTitle">3단계</h2>
                      <svg id="donut" viewBox="0 0 240 240" aria-label="도넛차트">
                        <circle cx="120" cy="120" r="84" fill="none" stroke="#eef1f5" stroke-width="24"/>
                        <g id="segments" transform="rotate(-90 120 120)"></g>
                        <g>
                          <text x="120" y="110" class="centerText muted" font-size="12">완료</text>
                          <text id="centerMain" x="120" y="130" class="centerText">0 / 5</text>
                        </g>
                      </svg>
                      <div class="hint">• 블록을 누르면 해당 단계로 전환되며 도넛은 초기화됩니다. 일부 선택=회색, 전부 선택=파란색.</div>
                    </div>
                   <div class="box" id="box">
                        <div class="slideshow-container">
                          <div class="slide">
                            투자전략 설계에 활용하고 싶은 알고리즘을 선택해주세요.
                          </div>
                          <div class="slide">
                           마우스를 올리면 각 알고리즘에 대한 설명을 확인할 수 있어요.
                          </div>
                        
                          

                          <!-- 버튼 -->
                           <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                          <a class="next" onclick="plusSlides(1)">&#10095;</a>

                          <!-- 점 -->
                          <div class="dots">
                            <span class="dot" onclick="currentSlide(1)"></span>
                            <span class="dot" onclick="currentSlide(2)"></span>
                            <span class="dot" onclick="currentSlide(3)"></span>
                          </div>
                        </div>
                        <div class="recommand" id="recommand">
                        </div> 
                        <div class="selectDataGroup" id="selectDataGroup">
                        </div> 
                      </div> 
                    </div> 
                  </div>
                  </div> 
                </div>
                
            </div>
          </div>
   
      <button id="directBtn">데이터 직접 선택하기</button> 
    </div>
    </section>

</body>
</html>

<script>
// 첫 번째 cbox 체크 시 슬라이드 문구 추가
document.addEventListener('change', (e) => {
  const firstCbox = document.querySelector('#recommand .cbox:first-child input[type="checkbox"]');
  if (!firstCbox) return;

  if (e.target === firstCbox && firstCbox.checked) {
    // alert 대신 슬라이드 문구 변경
    const slideContainer = document.querySelector(".slideshow-container");
    if (!slideContainer) return;

    // 기존 슬라이드/도트 제거
    slideContainer.querySelectorAll(".slide").forEach(s => s.remove());
    const dotsWrap = slideContainer.querySelector(".dots");
    if (dotsWrap) dotsWrap.innerHTML = "";

    // 새 문구 추가
    const div = document.createElement("div");
    div.className = "slide";
    div.textContent = "데이터부터 선택해 주세요.";
    div.style.display = "block"; // 첫 슬라이드만 보이게
    slideContainer.appendChild(div);

    // 점도 하나만
    if (dotsWrap) {
      const dot = document.createElement("span");
      dot.className = "dot active";
      dotsWrap.appendChild(dot);
    }
  }
});

document.addEventListener('change', (e) => {
  // recommand 안에 있는 모든 체크박스 수집
  const cboxes = document.querySelectorAll('#recommand input[type="checkbox"]');
  if (cboxes.length < 2) return; // 최소 2개 이상일 때만
  
  const secondCbox = cboxes[1]; // 두 번째 체크박스 (0=첫번째, 1=두번째)

  if (e.target === secondCbox && secondCbox.checked) {
    // ✅ 슬라이드 문구 교체
    const slides = document.querySelectorAll(".slideshow-container .slide");
    if (slides.length > 0) {
      slides.forEach(s => s.style.display = "none"); // 기존 슬라이드 숨기기
    }

    // 새 문구 추가
    const slideContainer = document.querySelector(".slideshow-container");
    const div = document.createElement("div");
    div.className = "slide";
    div.textContent = "XG부스트 알고리즘으로 투자전략을 만들어보겠습니다.";
    slideContainer.appendChild(div);

    // 새 슬라이드 표시
    div.style.display = "block";
  }
});


document.addEventListener('change', (e) => {
  const cboxes = document.querySelector('#recommand .cbox:nth-child(2) input[type="checkbox"]');
  if (cboxes.length < 2) return;   // 두 개 이상 있을 때만

  const secondCbox = cboxes[1];    // 0 = 첫 번째, 1 = 두 번째

  if (e.target === secondCbox && secondCbox.checked) {
    const slideContainer = document.querySelector(".slideshow-container");
    if (!slideContainer) return;

    let dotsWrap = slideContainer.querySelector(".dots");
    if (!dotsWrap) {
      dotsWrap = document.createElement("div");
      dotsWrap.className = "dots";
      slideContainer.appendChild(dotsWrap);
    }

    // 새 슬라이드
    const div = document.createElement("div");
    div.className = "slide";
    div.textContent = "XG부스트 알고리즘으로 투자전략을 만들어보겠습니다.";
    div.style.display = "none";
    slideContainer.appendChild(div);

    // 새 dot
    const dot = document.createElement("span");
    dot.className = "dot";
    dot.addEventListener("click", () => showSlides(dotsWrap.children.length));
    dotsWrap.appendChild(dot);
  }
});




  (() => {
  let __slideTimer = null;

  // 안전장치: 페이지 숨김 시 일시정지(선택)
  function stopSlideShow() {
    clearInterval(__slideTimer);
    __slideTimer = null;
  }
  document.addEventListener('visibilitychange', () => {
    if (document.hidden) stopSlideShow();
  });

  // 부모가 보내는 신호를 받은 뒤에만 시작
  window.addEventListener('message', (e) => {
    if (e?.data?.type === 'START_SLIDES') {
      window.startSlideShow(e.data.interval || 3000);
    }
  });

  
})();

// ===== #signup3 폼 ↔ 도넛 연동 (폼이 들어있는 카드 안의 도넛만 다시 그림) =====
(function bindDonutToSignup3(){
  const form = document.getElementById('signup3');
  if (!form) return;

  // 폼이 들어있는 카드 컨테이너 기준으로 도넛 요소 찾기(중복 ID 안전)
  const container   = form.closest('.card[data-step]') || document;
  const segGroup    = container.querySelector('#segments');
  const centerMain  = container.querySelector('#centerMain');
  const stepTitleEl = container.querySelector('#stepTitle');

  // (전역 cfg가 없을 때 대비한 기본값)
  const cfgLocal = window.cfg || {
    cx:120, cy:120, r:84, width:24, gapDeg:4,
    colorOn: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim() || '#2b6fff',
    colorOff: getComputedStyle(document.documentElement).getPropertyValue('--base').trim() || '#eef1f5'
  };

  const toRad  = d => d * Math.PI / 180;
  const polar  = (cx,cy,r,a)=>({ x: cx + r*Math.cos(toRad(a)), y: cy + r*Math.sin(toRad(a)) });
  const arcPath = (cx,cy,r,start,end)=>{
    const s = polar(cx,cy,r,start), e = polar(cx,cy,r,end);
    const large = ((end-start)%360) > 180 ? 1 : 0;
    return `M ${s.x} ${s.y} A ${r} ${r} 0 ${large} 1 ${e.x} ${e.y}`;
  };

  const fields = Array.from(form.querySelectorAll('input, select, textarea'))
    .filter(el => !el.disabled && el.type !== 'hidden');

  const isFilled = (el) => {
    if (el.type === 'checkbox' || el.type === 'radio') return el.checked;
    if (el.type === 'file') return (el.files?.length || 0) > 0;
    return (el.value || '').trim().length > 0;
  };

  function repaint(filled, total){
    if (!segGroup || !centerMain) return;
    segGroup.innerHTML = '';

    const gaps = cfgLocal.gapDeg * total;
    let cur = 0;
    for (let i=0; i<total; i++){
      const selected = i < filled;
      const sweep = (1/total) * (360 - gaps);
      const start = cur, end = cur + sweep; cur = end + cfgLocal.gapDeg;

      const path = document.createElementNS('http://www.w3.org/2000/svg','path');
      path.setAttribute('d', arcPath(cfgLocal.cx,cfgLocal.cy,cfgLocal.r,start,end));
      path.setAttribute('fill','none');
      path.setAttribute('stroke', selected ? cfgLocal.colorOn : cfgLocal.colorOff);
      path.setAttribute('stroke-width', cfgLocal.width);
      path.setAttribute('stroke-linecap','round');
      segGroup.appendChild(path);
    }

    centerMain.textContent = `${filled} / ${total}`;
    if (stepTitleEl) {
      const stepIdx = Number(container.dataset.step || 0);
      const stepName = (window.steps && window.steps[stepIdx]?.name) || '';
      stepTitleEl.textContent = `3단계 · ${stepName}`;
    }
  }

  function update(){
    const total  = fields.length;
    const filled = fields.reduce((n, el) => n + (isFilled(el) ? 1 : 0), 0);
    repaint(filled, total);
  }

  fields.forEach(el => el.addEventListener('input',  update));
  fields.forEach(el => el.addEventListener('change', update));

  // 초기 1회 갱신
  update();
})();


</script>
